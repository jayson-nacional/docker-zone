FROM archlinux:latest

# system update
RUN pacman --noconfirm -Syu

# version control
RUN pacman -S --noconfirm  git 

# multiplexer
RUN pacman -S --noconfirm tmux

# zsh
RUN pacman -S --noconfirm zsh \
	zsh-completions

# terminal
RUN pacman -S --noconfirm ncurses
ENV TERM=alacritty

# openssh
RUN pacman -S --noconfirm openssh

# c support
RUN pacman -S --noconfirm gcc
RUN pacman -S --noconfirm make

# dotnet
RUN pacman -S --noconfirm dotnet-sdk-8.0
RUN pacman -S --noconfirm aspnet-runtime-8.0

# golang
RUN pacman -S --noconfirm go

# utilities
RUN pacman -S --noconfirm nodejs \
	npm \
	unzip \
	ripgrep

# neovim
RUN pacman -S --noconfirm neovim

ENV USER=nash
RUN useradd $USER
USER $USER

WORKDIR /home/$USER

SHELL ["/usr/bin/zsh", "-c"]
RUN mkdir development
RUN mkdir .ssh
RUN mkdir .config

# omnisharp decompilation support
RUN mkdir .omnisharp
RUN echo '{ "RoslynExtensionsOptions": { "enableDecompilationSupport": true } }' > .omnisharp/omnisharp.json

# configs
RUN git clone https://github.com/jayson-nacional/neovim-config.git .config/nvim
RUN git clone https://github.com/tmux-plugins/tpm .tmux/plugins/tpm
RUN git clone https://github.com/jayson-nacional/tmux-config.git .config/tmux
RUN sh -c "$(curl -fsSL https://raw.githubusercontent.com/ohmyzsh/ohmyzsh/master/tools/install.sh)" --unattended
RUN git clone --depth=1 https://github.com/romkatv/powerlevel10k.git "${ZSH_CUSTOM:-$HOME/.oh-my-zsh/custom}/themes/powerlevel10k"

COPY .zshrc .
COPY .p10k.zsh .

CMD ["/bin/zsh"]
